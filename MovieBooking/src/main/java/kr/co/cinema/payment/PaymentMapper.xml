<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="kr.co.cinema.payment.PaymentMapper">
	
	<!-- 결제페이지 영화정보 보여주기 -->
	<select id="">
		SELECT 
			SCREEN_SCHEDULE.scs_code,
			MOVIE.mov_korName,
			MOVIE.mov_grade,
			MOVIE.mov_runningTime,
			MOVIE.mov_imgPath,
			SCREEN_SCHEDULE.scs_startTime,
			SCREEN_SCHEDULE.scs_date,
			SCREEN_SCHEDULE.scs_timeDiscount,
			BRANCH.brc_local,
			BRANCH.brc_name
		FROM
			SCREEN_SCHEDULE
		JOIN
			MOVIE
		ON
			SCREEN_SCHEDULE.mov_code = MOVIE.mov_code
		JOIN
			BRANCH
		ON
			SCREEN_SCHEDULE.brc_code = BRANCH.brc_code
		WHERE
			scs_code="43170221101101114"
	</select>
	
	<!-- 결제페이지 할인정보 가져오기 -->
	<select id="selectDiscountInfo" resultType="kr.co.cinema.dto.DiscountInfo">
		SELECT 
			dcinf_code AS dcinfCode,
			dcinf_info AS dcinfInfo,
			dcinf_price AS dcinfPrice,
			dcinf_applyYear AS dcinfApplyYear,
			dcinf_status AS dcinfStatus
		FROM 
			DISCOUNT_INFO
		WHERE 
			dcinf_status="적용"
	</select>

	<!-- 결제 등록 -->
	<insert id="insertPayment" parameterType="kr.co.cinema.dto.Payment">
		INSERT INTO PAYMENT(
			pmt_code,
			scs_code,
			mem_id,
			nmem_code,
			scco_code,
			dcinf_code,
			pmt_ticketNum,
			pmt_price,
			pmt_date
		) VALUES (
			pmtCode,
			scsCode,
			memId,
			nmemCode,
			sccoCode,
			dcinfCode,
			pmtTicketNum
			pmtPrice,
			now()
			)
	</insert>
	
	
</mapper>